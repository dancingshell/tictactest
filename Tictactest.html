<!DOCTYPE html>
<html ng-app="tictactoe">
<head>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js" type="text/javascript"></script>
  <title>TicTacTest</title>
</head>
<body ng-controller="cube">

  <section id="results">
    <div id="game_start" ng-show="player=='Start'">
      <h3>Start Game:</h3><hr/>
      <h4 ng-show="phase<=1">Enter Your name:</h4>
      <div id="getplayer1"><p>Player 1: {{player1_input}}</p><input ng-show="phase==0" type="text" ng-model="player1_input" class="name_textbox" placeholder="Player 1"></input>
      <input ng-show="phase==0" type="button" value="Submit" ng-click="namePlayer(1)"></input></div>

      <div id="getplayer2"><p>Player 2: {{player2_input}}</p><input ng-hide="phase>=2" type="text" ng-model="player2_input" class="name_textbox" placeholder="Player 2"></input>
      <input ng-show="phase<2" type="button" value="Submit" ng-click="namePlayer(2)"></input></div>
      <h3 ng-show="phase>=2">Choose a Square</h3>
    </div>
    <div id="results_box" ng-show="player!='Start'">
        <h3>Next Turn:</h3><hr>
        <p>{{next_turn}}</p><div id="player_icon" class="box ng-class:p_number"></div>
        <h3>Moves Remaining:</h3><hr>
        <div class="turn_count"><p>{{player1_input}}: Some Number</p><div id="player_icon" class="p1"></div></div>
        <div class="turn_count"><p>{{player2_input}}: Other Number</p><div id="player_icon" class="p2"></div></div>
    </div>
  </section>

   <section id="players">
    <div id="game_players" ng-show="player!='Start'">
        <h3>Players:</h3><hr>
        <div class="turn_count"><p>{{player1_input}}</p><div id="player_icon" class="p1"></div></div>
        <div class="turn_count"><p>{{player2_input}}</p><div id="player_icon" class="p2"></div></div>
    </div>
  </section>

  <section  id="grid">
    <section id="columnA" class="boxes">
      <div id="0" class="box columnA ng-class: results[0];" ng-click="player_move($event)"></div>
      <div id="1" class="box columnA ng-class: results[1];" ng-click="player_move($event)"></div>
      <div id="2" class="box columnA ng-class: results[2];" ng-click="player_move($event)"></div>
    </section>

    <section id="columnB" class="boxes">
      <div id="3" class="box columnB ng-class: results[3];" ng-click="player_move($event)"></div>
      <div id="4" class="box columnB ng-class: results[4];" ng-click="player_move($event)"></div>
      <div id="5" class="box columnB ng-class: results[5];" ng-click="player_move($event)"></div>
    </section>

    <section id="columnC" class="boxes">
      <div id="6" class="box columnC ng-class: results[6];" ng-click="player_move($event)"></div>
      <div id="7" class="box columnC ng-class: results[7];" ng-click="player_move($event)"></div>
      <div id="8" class="box columnC ng-class: results[8];" ng-click="player_move($event)"></div>
    </section>
    {{}}
    <!-- Total Results: {{results}}<br/>
    Player 1 Results: {{p1results}}<br/>
    Player 2 Results: {{p2results}}<br/> -->
  </section>
  
<script type="text/javascript">
  angular.module("tictactoe", [])
    .controller('cube', ['$scope', function($scope) {
      $scope.moves = 1; //no moves have been made
      $scope.player = "Start";
      $scope.p_number = ""; //player is undefined initially
      $scope.results = ['','','','','','','','',''];
      $scope.p1results = ['','','','','','','','',''];
      $scope.p2results = ['','','','','','','','',''];
      $scope.phase = 0;
    
      $scope.namePlayer = function(player){
        console.log("test + player");
      if (player == 1) {
        // if (player1_input=""){
        //   player1_input = "Player 1";
        // }
        $scope.phase +=1;}
      else {
        // if (player_input=""){
        //   player1_input = "Player 1";
        // }
        $scope.phase +=2;}
        // if ($scope.phase ==3){
        //   console.log($scope.phase);
        //   alert("Great! Let's play " + $scope.player1_input + " and " + $scope.player2_input) + ".";}
      
      
      }

      $scope.player_move = function(box_clicked) {
        var box_number = box_clicked.target.id;
        console.log("x" + $scope.player2_input + "x");
        if ($scope.player1_input==undefined){
          $scope.player1_input = "Player 1";
        }
        if ($scope.player2_input==undefined){
          $scope.player2_input = "Player 2";
        }

        if ($scope.moves %2!=0){ //odds (player 1)
          $scope.player = "Player 1";
          $scope.p_number = "p2";
          play_game(box_number, "p1", "p2");}
        else { //even (player 1)
          $scope.player = "Player 2";
          $scope.p_number = "p1";
          play_game(box_number, "p2", "p1");}
      }

      var play_game = function(box, player, opponent) {
        if ($scope.results[box] == opponent){
          alert("Your opponent already owns that space. Choose Another");}
        else if ($scope.results[box] == player){
          alert("You already own that space. Choose Another");}
        else {
          $scope.results[box] = player;
          $scope.moves ++;
          if ($scope.player == "Player 1"){
            $scope.next_turn = $scope.player2_input;
            $scope.p1results[box] = player;}
          else{
            $scope.p2results[box] = player;
            $scope.next_turn = $scope.player1_input;}
        
          // var i = 0;
          // while (i< 9) {
          //   if($scope.p1results[i] != ""){
          //     $scope.p1count[i] = "x";
          //     i++;}
          // }
        }
      }

    }]);
</script>  
</body>
</html>